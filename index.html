<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	

	<title>Code Paradise</title>
	<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
	
	
	<link rel="stylesheet" href="/css/normalize.css" type="text/css">
	<link rel="stylesheet" href="/css/basscss.css" type="text/css">
	<link rel="stylesheet" href="/css/basscss-ui-groups.css" type="text/css">
	<link rel="stylesheet" href="/css/tomorrow.css" type="text/css">
	<link rel="stylesheet" href="/css/style.css" type="text/css">
	
		<link href="https://g.mirror.sh/gapi/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
	

	<!--[if lt IE 9]><script src="/js/html5.js" type="text/javascript"></script><![endif]-->
	<script src="/js/main.js" type="text/javascript"></script>
</head>

<body>
	<section class="container m4 clearfix">
		<div class="clearfix">
			<div class="mb4 sm-flex center nowrap">
	<div class="flex-auto block">
		<p class="inline h2">Code Paradise</p> | <small class="muted">只要凭借自己的意志做出的行动才有意义——笛卡尔。</small>
	</div>
</div>

			<div class="mn1 center">
	
		<a href="/./" class="btn button-narrow">Home</a>
	
		<a href="/archives/" class="btn button-narrow">Archives</a>
	
		<a href="/Categories/" class="btn button-narrow">Categories</a>
	
		<a href="/tags/" class="btn button-narrow">Tags</a>
	
	<a href="/search.html" class="btn button-narrow" onclick="loadJQuery(this, event);" data-modal>
		<svg class="icon" data-icon="search"></svg>
	</a>
</div>

			<div class="p0 col col-12">
				
	<div class="m0 py2">
	<div class="md-col-12">
		<div class="overflow-hidden bg-white rounded">
			<div class="m1 p2 white">
				<div class="clearfix">
					<div class="left">
						<h1 class="h2 m0"><a href="/2016/06/10/vitual/" class="black">
						C++的精髓 虚函数
						</a></h1>
					</div>
					<div class="right"><span class="h6 muted black">
						Jun 10 2016
					</span></div>
				</div>
			</div>
			<div class="p2 border-top">
				<h2 id="1-虚函数的作用"><a href="#1-虚函数的作用" class="headerlink" title="1. 虚函数的作用"></a>1. 虚函数的作用</h2><p>为了实现多态，引入虚函数。<br>那什么是多态？<br>一言以蔽之：<strong>多态是指同一个方法在派生类和基类中的行为是不同。</strong><br>或者说：<strong>多态是指使用相同的函数名来调用函数不同的实现方法，即“一种接口，多种方法”。</strong>  </p>
<p>C++实现多态的方法有两种：</p>
<ul>
<li>编译时多态：通过函数重载实现（静态联编）</li>
<li>运行时多态：通过虚函数实现（动态联编）</li>
</ul>
<h2 id="2-虚函数的定义和使用"><a href="#2-虚函数的定义和使用" class="headerlink" title="2. 虚函数的定义和使用"></a>2. 虚函数的定义和使用</h2><p>在基类中定义虚函数：</p>
<pre><code>class Student 
{
    char name[50];
public:
    virtual void show_name();    /* virtual修饰的函数就是虚函数 */
}
</code></pre><p>使用虚函数：</p>
<p>当函数是通过引用或者指针而不是对象调用的，这时需要注意：</p>
<ul>
<li>（1）如果该方法没有使用关键字virtual，程序将根据引用类型或指针类型选择函数；</li>
<li>（2）如果使用了virtual，程序将根据引用或指针指向的对象的类型来选择函数。</li>
</ul>
<h2 id="3-虚函数的工作原理"><a href="#3-虚函数的工作原理" class="headerlink" title="3. 虚函数的工作原理"></a>3. 虚函数的工作原理</h2><p>编译器处理虚函数的方法是：<br>给每个对象添加一个隐藏成员（取该对象占的内存空间不确定是否会看到？），隐藏成员中保存了一个指向函数地址数组的指针。该函数地址数组成为虚函数表（virtual function table, vtbl）。虚函数表中保存着类对象声明的虚函数的地址。</p>
<pre><code>一个基类对象，该对象包含一个指针，指向保存基类中所有虚函数地址的地址表vtbl1；
一个派生类对象，该对象包含一个指针，指向保存派生类中所有虚函数地址的地址表vtbl2；
如果派生类提供了虚函数的新定义，则虚函数地址表中保存新的地址；如果派生类定义了新的虚函数，则新函数的地址也要加入到vtbl2中。
</code></pre><p>调用虚函数时：<br>程序查看对象中vtbl地址，然后转向相应的函数地址表中，再找到调用的虚函数地址，执行该虚函数。<br><strong>虚函数表中地址的顺序</strong>：</p>
<ul>
<li>虚函数按照其声明顺序放于表中</li>
<li>父类的虚函数在子类的虚函数前面  </li>
</ul>
<p><a>最好能写程序验证一下。</a></p>
<h2 id="4-虚函数的代价"><a href="#4-虚函数的代价" class="headerlink" title="4. 虚函数的代价"></a>4. 虚函数的代价</h2><p>使用虚函数，在内存和执行速度方面有一定的成本：</p>
<ul>
<li>（1）每个对象实际占的空间增大，增大量是存储地址的空间；</li>
<li>（2）对于每一个类，编译器都需要创建一个虚函数表；</li>
<li>（3）对于每个函数调用，都需要执行一项额外的操作，即表中查找地址。（主要是因为虚函数是动态联编，非虚函数是静态联编，则不要额外的操作）</li>
</ul>
<h2 id="5-虚函数相关注意事项"><a href="#5-虚函数相关注意事项" class="headerlink" title="5. 虚函数相关注意事项"></a>5. 虚函数相关注意事项</h2><h3 id="5-1-构造函数"><a href="#5-1-构造函数" class="headerlink" title="5.1 构造函数"></a>5.1 构造函数</h3><p>构造函数不能是虚函数.</p>
<h3 id="5-2-析构函数"><a href="#5-2-析构函数" class="headerlink" title="5.2 析构函数"></a>5.2 析构函数</h3><p>析构函数应该是虚函数，除非类不用做基类。<br>通常会给基类提供一个虚析构函数，即使它并不需要析构函数。</p>
<h2 id="6-虚函数与纯虚函数的区别"><a href="#6-虚函数与纯虚函数的区别" class="headerlink" title="6. 虚函数与纯虚函数的区别"></a>6. 虚函数与纯虚函数的区别</h2><ul>
<li>（1）虚函数可以被直接使用，也可以被子类重载以后以多态的形式调用，而纯虚函数必须在子类中实现该函数才可以使用，因为纯虚函数在基类只有声明而没有定义;</li>
<li>（2）虚函数和纯虚函数都可以在子类中被重载，以多态的形式被调用;</li>
<li>（3）定义不同<ul>
<li>虚函数定义：virtual func() {method body} ;</li>
<li>纯虚函数定义：virtual func() = 0;</li>
</ul>
</li>
<li>（4）含有纯虚函数的类才能称为抽象类。</li>
</ul>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><p>[1] 《C++ prime plus》第六版<br>[2] 《C++ prime plus》第五版<br>[3]  <a href="http://blog.csdn.net/wuchuanpingstone/article/details/6742465" target="_blank" rel="external">http://blog.csdn.net/wuchuanpingstone/article/details/6742465</a><br>[4]  <a href="http://www.cnblogs.com/bluestorm/archive/2012/08/29/2662350.html" target="_blank" rel="external">http://www.cnblogs.com/bluestorm/archive/2012/08/29/2662350.html</a> 虚函数和纯虚函数区别</p>

			</div>
			<div class="p2 border-top">
				<div class="clearfix">
					<div class="left">
						
					</div>
					<div class="ml2 right"><span class="h6 muted black"> </span></div>
				</div>
			</div>
		</div>
	</div>
	
</div>


	<div class="m0 py2">
	<div class="md-col-12">
		<div class="overflow-hidden bg-white rounded">
			<div class="m1 p2 white">
				<div class="clearfix">
					<div class="left">
						<h1 class="h2 m0"><a href="/2016/06/08/construct-blog/" class="black">
						hexo+github搭建个人博客
						</a></h1>
					</div>
					<div class="right"><span class="h6 muted black">
						Jun 8 2016
					</span></div>
				</div>
			</div>
			<div class="p2 border-top">
				<h2 id="1-安装hexo"><a href="#1-安装hexo" class="headerlink" title="1. 安装hexo"></a>1. 安装hexo</h2><h3 id="安装过程："><a href="#安装过程：" class="headerlink" title="安装过程："></a>安装过程：</h3><pre><code>$sudo npm install -g hexo
$hexo init blog    /* blog指你自己命名的文件夹 */
$cd blog
$npm install    /* 安装依赖包 */
$hexo server 或者 hexo s    /* 启动hexo */
</code></pre><h3 id="验证hexo启动成功"><a href="#验证hexo启动成功" class="headerlink" title="验证hexo启动成功"></a>验证hexo启动成功</h3><p>在浏览器地址栏输入localhost:4000，看到Hexo的hello world，编程初学一般都是hello world。<br><strong>注意：hexo server现在不能control+c停止掉</strong></p>
<h2 id="2-开始写一个post测试一下"><a href="#2-开始写一个post测试一下" class="headerlink" title="2. 开始写一个post测试一下"></a>2. 开始写一个post测试一下</h2><p>现在hexo已经安装好，我们来测试一下吧。</p>
<pre><code>$hexo new &quot;博文的名字&quot;
</code></pre><p>刷新<a href="http://localhost:4000/" target="_blank" rel="external">http://localhost:4000/</a>，可以发现已生成一篇新文章 “博文的名字”</p>
<h2 id="3-部署到github上"><a href="#3-部署到github上" class="headerlink" title="3. 部署到github上"></a>3. 部署到github上</h2><h3 id="创建SSH-key"><a href="#创建SSH-key" class="headerlink" title="创建SSH key"></a>创建SSH key</h3><p>查看是否有id_rsa.pub文件 </p>
<pre><code>ls -a ~/.ssh/
</code></pre><p>如果没有SSH key，参考<a href="http://www.jianshu.com/p/13e64c9e2295" target="_blank" rel="external">[2]</a>生成新的SSH key。</p>
<h3 id="设置github-SSH-key"><a href="#设置github-SSH-key" class="headerlink" title="设置github SSH key"></a>设置github SSH key</h3><p>在github账号中添加key，登陆GitHub-&gt;Settings-&gt;SSH and GPG keys，然后，点“New SSH Key”，任意起一个Title，在Key文本框里粘贴id_rsa.pub文件的内容，点“Add Key”。<br>这里我遇到一个问题：</p>
<pre><code>vim打开id_rsa.pub文件，粘贴复制，报错:
key is invalid. Ensure you&apos;ve copied the file correctly.
</code></pre><p>解决方法是：</p>
<pre><code>cat命令输出~/.ssh/id_rsa.pub内容到终端，再拷贝，添加成功。
</code></pre><p>参考 <a href="http://blog.csdn.net/hfut_wowo/article/details/44131383" target="_blank" rel="external">github add SHH key failed</a></p>
<h3 id="创建github库"><a href="#创建github库" class="headerlink" title="创建github库"></a>创建github库</h3><p>登录你的Github帐号，新建仓库，仓库名为<strong>用户名</strong>.github.io固定写法，一定要和用户名相同。</p>
<h3 id="修改-config-yml文件"><a href="#修改-config-yml文件" class="headerlink" title="修改_config.yml文件"></a>修改_config.yml文件</h3><p>修改如下：</p>
<pre><code>deploy:
 type: git
 repository: https://github.com/用户名/用户名.github.io.git
 branch: master
</code></pre><h3 id="验证成功"><a href="#验证成功" class="headerlink" title="验证成功"></a>验证成功</h3><p>在hexo init的目录下依次执行：  </p>
<pre><code>$hexo generate或者hexo g  
$hexo deploy或者hexo d
</code></pre><p>两步也可以合成：hexo d -g<br>再在浏览器输入：<a href="http://user_name.github.io" target="_blank" rel="external">http://user_name.github.io</a>，可以看到你的博文了。<br>如果hexo deploy报错，解决方法是：</p>
<pre><code>$npm install hexo-deployer-git --save
</code></pre><h2 id="4-更换主题"><a href="#4-更换主题" class="headerlink" title="4. 更换主题"></a>4. 更换主题</h2><p>参考<a href="http://www.jianshu.com/p/13e64c9e2295" target="_blank" rel="external">[2]</a>介绍更换主题的过程，并推荐了几种选择的主题。</p>
<pre><code>$git clone https://github.com/iissnan/hexo-theme-next themes/next
修改_config.yml文件
$hexo clean
$hexo generate
$hexo deploy
</code></pre><p>就这么几步，主题就更换成功了。</p>
<h2 id="5-创建分类页面"><a href="#5-创建分类页面" class="headerlink" title="5. 创建分类页面"></a>5. 创建分类页面</h2><p>发现没有分类页面，创建：</p>
<pre><code>$hexo new page categories    /* create a new page */
$vim index.md        /* edit the tyep is categories */
编辑themes/next/_config.yml文件，添加categories
</code></pre><h2 id="6-参考博文"><a href="#6-参考博文" class="headerlink" title="6. 参考博文"></a>6. 参考博文</h2><p>[1] <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">https://hexo.io/docs/deployment.html</a><br>[2] <a href="http://www.jianshu.com/p/13e64c9e2295" target="_blank" rel="external">http://www.jianshu.com/p/13e64c9e2295</a><br>[3] <a href="http://www.cnblogs.com/zhcncn/p/4097881.html" target="_blank" rel="external">http://www.cnblogs.com/zhcncn/p/4097881.html</a><br>[4] <a href="http://blog.csdn.net/wwj_748/article/details/45896373" target="_blank" rel="external">http://blog.csdn.net/wwj_748/article/details/45896373</a><br>[5] <a href="http://jingyan.baidu.com/article/d8072ac47aca0fec95cefd2d.html" target="_blank" rel="external">http://jingyan.baidu.com/article/d8072ac47aca0fec95cefd2d.html</a></p>

			</div>
			<div class="p2 border-top">
				<div class="clearfix">
					<div class="left">
						
					</div>
					<div class="ml2 right"><span class="h6 muted black"> </span></div>
				</div>
			</div>
		</div>
	</div>
	
</div>


<div class="clearfix">
	
	
	<div class="overflow-hidden sm-show center">
		
			<a href="/" class="btn btn-primary bg-gray">1</a>
		
		
		
			
		
			
		
		
		
			
		
			
		

		

		
	</div>
</div>



			</div>
		</div>
	</section>
	<div class="container mb2 clearfix">
	<div class="sm-flex center nowrap mb2 h5">
		<div class="flex-auto border-bottom">
			<a href="https://hexo.io/" class="btn block muted">Hexo</a>
		</div>
		<div class="flex-auto border-bottom">
			<a href="https://jerry.im/essays/2016/02/hexo-theme-weightless/" class="btn block">Weightless</a> Theme
		</div>
		<div class="flex-auto border-bottom">
			Rocking <a href="http://www.basscss.com/" class="btn block">Basscss</a>
		</div>
		<div class="flex-auto border-bottom">
			
		</div>
	</div>
</div>
<script src="/js/geomicons.js"></script>
<script type="text/javascript">
	var icons = document.querySelectorAll('[data-icon]');
	geomicons.inject(icons);
</script>


	<!-- Piwik -->
	<script type="text/javascript">
	  var _paq = _paq || [];
	  _paq.push(['trackPageView']);
	  _paq.push(['enableLinkTracking']);
	  (function() {
	    var u="//communistanalytics.com/";
	    _paq.push(['setTrackerUrl', u+'piwik.php']);
	    _paq.push(['setSiteId', 1]);
	    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
	    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
	  })();
	</script>
	<noscript><p><img src="//communistanalytics.com/piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript>
	<!-- End Piwik Code -->



</body>
</html>
